<%- include('navbar.ejs') %>
<div class="container mb-5">
    <div class="row justify-content-center mt-5">
        <div class="col-md-6 border rounded shadow-lg">
            <div class="col-md-1"></div>
            <h2 class="text-center m-3">Register</h2>
            <form action="/do_register" method="post">
                <div class="mb-3">
                    <label class="form-label">Full Name</label>
                    <input type="text" name="customer_name" class="form-control" placeholder="Enter your full name" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Email address</label>
                    <input type="email" name="customer_email" class="form-control" placeholder="Enter your email" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Mobile number</label>
                    <input type="number" name="customer_mobile" class="form-control" placeholder="Enter your mobile" required>
                </div>
                <div class="mb-3">
                    <label>Password:</label>
                    <div class="input-wrapper">
                        <input type="password" name="customer_password" class="form-control" id="password" oninput="checkPasswordMatch()" required>
                        <span id="password-toggle" class="eye-icon"></span>
                    </div>
                    <div class="strength-meter" id="strength-meter"></div>
                    <p id="strength-text"></p>
                </div>
                <div class="mb-3">
                    <label>Confirm Password:</label>
                    <div class="input-wrapper">
                        <input type="password" class="form-control" id="confirmPassword"  oninput="checkPasswordMatch()">
                        <span id="password-toggle" class="eye-icon"></span>
                    </div>
                    <p id="message"></p> 
                </div>
                <button class="btn btn-dark w-100" id="submitButton">Register</button>
            </form>
            <div class="mt-3 text-center">
                <p>Already have an account? <a href="/login">Login here</a></p>
            </div>
            <div class="col-md-1"></div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
    var passwordInput = document.getElementById('password');
    var confirmPasswordInput = document.getElementById('confirmPassword');
    var passwordToggle = document.getElementById('password-toggle');
    var submitButton = document.getElementById('submitButton');
    var message = document.getElementById('message');
    var strengthMeter = document.getElementById('strength-meter');
    var strengthText = document.getElementById('strength-text');

    // Toggle password visibility
    passwordToggle.addEventListener('click', function () {
    if (passwordInput.type === 'password') {
      passwordInput.type = 'text';
      passwordToggle.classList.remove('animate-open');
      passwordToggle.classList.add('animate-close');
    } else {
      passwordInput.type = 'password';
      passwordToggle.classList.remove('animate-close');
      passwordToggle.classList.add('animate-open');
    }
  });

    // Check password match
    function checkPasswordMatch() {
        var password = passwordInput.value;
        var confirmPassword = confirmPasswordInput.value;

        if (password === confirmPassword && password !== "") {
            submitButton.disabled = false;
            message.textContent = "Passwords match!";
            message.style.color = "green";
        } else {
            submitButton.disabled = true;
            message.textContent = "Passwords do not match.";
            message.style.color = "red";
        }
    }

    passwordInput.addEventListener('input', checkPasswordMatch);
    confirmPasswordInput.addEventListener('input', checkPasswordMatch);

    // Update strength meter
    passwordInput.addEventListener('input', function () {
        var passwordValue = passwordInput.value;
        var strength = checkPasswordStrength(passwordValue);

        strengthMeter.style.width = `${strength.percent}%`;
        strengthMeter.style.backgroundColor = strength.color;
        strengthText.textContent = strength.message;
    });

    function checkPasswordStrength(password) {
        let strength = 0;

        if (password.length >= 8) strength++;
        if (/[A-Z]/.test(password)) strength++;
        if (/[a-z]/.test(password)) strength++;
        if (/\d/.test(password)) strength++;
        if (/[^\w]/.test(password)) strength++;

        var percent = (strength / 5) * 100;
        var colors = ["#e0e0e0", "red", "orange", "yellowgreen", "green"];
        var messages = ["Too Short", "Weak", "Moderate", "Strong", "Very Strong"];

        return {
            percent,
            color: colors[strength],
            message: messages[strength]
        };
    }

    // Optional: Submit button action
    submitButton.addEventListener('click', function () {
        alert("Passwords match! Form submitted.");
    });
});

</script>

<%- include('footer.ejs') %>